#include "Level.h"
#include "Macro.h"
#include "Filestream.h"

Level::Level()
{
	/*map = {
	"999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
	"999999999999999999999999999999999999999999999999999999999999999999999999999995995959999999999999999999999999999999999999999999999999999999999999999999",
	"999999999999999999999999999999999999999999999999999999999995555555555555555555555555555555555999999999999999999999999999999999999999999999999999999999",
	"999999999999999999999999999999999999999999999955555555555555555555555555555555555555555555555555555555999999999999999999999999999999999999999999999999",
	"999999999999999999999999999999999999955555555555555555555555555555555555555555553355555555555555555555555555999999999999999999999999999999999999999999",
	"999999999999999999999999999999955555555555555555555555553333333333333333594434355333333555555555555555555555555559999999999999999999999999999999999999",
	"999999999999999999999999955555555555555555535333333333333333333333343353333455533453555555555555555555555555555555559999999999999999999999999999999999",
	"999999999999999999999555555555555555333333333333333333333333344333134544343433353455555555955555333333333335555555555559999999999999999999999999999999",
	"999999999999999955555555555553333333333333333333333333333333335554435453939599995533599999994555121434433333333355555555555599999999999999999999999999",
	"999999999999995555555333333333435333333333333333333333333333355599113555993353443114399999999543111111434333333333555555555555999999999999999999999999",
	"999999999999555555333344333333334433353334433333444333333333355551434444334434345534445999995553341113533343333333333355555555555999999999999999999999",
	"999999999955555553555999522114113435333334143333333333333333355993544444444443343334444355314333335333553443443333333333555555555559999999999999999999",
	"999999999955555553553555534221111133111111133344444444433333555999533343999953355595953431343444333443344444443333333333333355555555599999999999999999",
	"999999999555553112001555400200212112444444444444444433333355559999934459995959955343335955959995599555595999555333333333333333555555555999999999999999",
	"999999999555342000202000000022211111144444444444443333333555599999135333344555599555559595553555599955594435595533333333333333335555555599999999999999",
	"999999999341444333411220021444444111114441444444443333335555555553934143355344553353553333344533553595534359333135333333333333333355555559999999999999",
	"999999953333333344444111433333333333333334443333443332135535555354114441333444333355533333444344344395593535933345333333333333333333555555599999999999",
	"999993344344333333333333333333333333333333333333333441412231414453344444435555599953333333555555344435559533331339533333333333333333355555559999999999",
	"999999995555555333333333333333333333333333333333333411444345355355995555595555553444444443333535533333435555953599533333333333333333335555555999999999",
	"999999999555555533333333333333333333333333333333333311333445535359795995993345353411111434344353344443443335545359533333344433333333333555555999999999",
	"999999999555555533333333333333333333333333333333333554144435535553955955444444355111221443433334411114444345935555333333353333443333333555555599999999",
	"999999999555555533333333333333333333344444433333333355113113355355355933434434334114233433133441231222134333999955333333314333111143333355555559999999",
	"999999999555555533333333333333333333444444444433333355353214149535955593434434411114334344341124211214434433995555333334441222220033533335555559999999",
	"999999995555555533333333333333333333344444444443333555553422135953555495533445314113441441433312141222133544555535341211122144441114333335555555999999",
	"999999995555555533333333333333333333334444444433335555993342435434353493959595311212114953134224224531431444455555333334144433333333353335555555999999",
	"999999955555555333333333333333333333333344444333355559995355139555355593533455341111534441393132334951441335335555553333344443333333333333555555999999",
	"999999955555555333333333333333333333333333333335555999955533353993335335533555343454200043513033153421113441455555553333333333333333333333555555999999",
	"999999955555555333333333333333333333333333333334244114445533355553444444444333442415410202424402445314434441144355335533333333333333333333555555999999",
	"999999955555555333333333333333335555555555554455341444414221355535335534444443394244311024541223344444333341455444445333333333333333333333555555999999",
	"999999955555553333333333333333555555555555551435555354355555333333333355534449935514435443333443344414555545535511445933333333333333333333555555999999",
	"999999955555553333333333333555314533433354334343534433343434333355955534533443534334444444533444333544355354393443343993333333333333333333555555999999",
	"999999955555555333333333353111434441441121233355533335535535339595553359555453544355534335434444455433555553353333455593333333333333333333555555999999",
	"999999995555555333333333433111135511121424414335334359934595555331144443335553393443335533399444353343335555355344459353113333333333333333555555999999",
	"999999995555555333333333434443555553555551441145553559954435445595435555355399955534444335435555555555555553443443559543413333333333333333555555999999",
	"999999995555555533333355335953535344443414433444531455343333444544434445933353555533334443343435355533334444344434595434333433333333333335555559999999",
	"999999995555555533333353333553353334433433359545535399534344444444544334434434433333444443444335333335333433355444555343455553333333333335555559999999",
	"999999995555555553333355345454353555355333455439533355533344543439441133145455334443335333355343333444335533553344334445595933333333333355555559999999",
	"999999999555555553333335555344443355355344444433555555999993333133533544435533344435441334421114422234445359353435443445393933333333333355555599999999",
	"999999999555555553333333555555314343933144433144534595355595545353435344343533555354341142122411112213534333353433435555359533333333333555555599999999",
	"999999999555555555333333335555595434433411141111444445314555559534444443443343345422453413222422111333435555555553435535359533333333333555555999999999",
	"999999999955555555333333333555559931313442222221111444955359595599955334353333459532114411422134212245441143355553555444395533333333335555555999999999",
	"999999999955555555333333333335555595432422222222133534439999559555599535534434444143002341241222244212134344343535533113595333333333335555559999999999",
	"999999999955555555333333333333355554421222235941154335995359555555955533344433443410025555533142414424244111143339355343995333333333335555559999999999",
	"999999999955555555333333333333333555341001214443111555333359935955599953344454539410000224433444433223133359543339559955553333333333355555559999999999",
	"999999999955555555333333333333333555339410014243415595333334355959359545599933354421120011110324013104413339934415555555333333333333555555559999999999",
	"999999999955555555333333333333333335533141114441433355543535333333555555555954341120434010000241002221341455933455555533333333333333555555599999999999",
	"999999999955555555333333333333333333553221433344333555593335953334333335553454444113433101112333312141441413535555533333333333333333555555599999999999",
	"999999999955555555333333333333333333355555599999995533555333333443435559359593344355333311444495344444444449555555333333333333333333555555599999999999",
	"999999999995555555333333333333333333335555599999993533359933334434443354593549343435334344334455541434443555355555333333333333333333555555599999999999",
	"999999999995555555333333333333333333333555599553113113335534444554143443311433393499534434434444443534344953343555333333333333333333555555599999999999",
	"999999999995555555533333333333333333333555514144143433355544331141111115395995455334554443443444353353444939344555333333333333333333555555599999999999",
	"999999999995555555533333333333333333333542443111441333343343593411111111435953435343444444435334444594394534445553333333333333333333555555599999999999",
	"999999999995555555533333333333333333333331144334413422144444359511114411445954445354435433535353553555355555455533333333333333333333555555599999999999",
	"999999999995555555533333333333333333333355444431222243334341141111145411144334435344355434443533333555955553555333333333333333333333555555999999999999",
	"999999999995555555553333333333333333333355555541412144333341111111115411333355555559955444433555553555343355353333333333333333333333555555999999999999",
	"999999999995555555553333333333333333333335559999343344444431222111211111113553355343353534355555555333433554453333344444444333333333555555999999999999",
	"999999999995555555553333333333333333333333555999933333331122245332222211114411444433335555555555333439594435553333333444443333333333555555999999999999",
	"999999999995555555555333333333333333333333555999344144331222225522222221111113444443554459443444444335993455533333344444444433333333555555999999999999",
	"999999999999555555555333333333333333333333355599993411143422222221554221145349333955495435953433453555533333333333333333333333333333555555999999999999",
	"999999999999555555555333333333333333333333355599999443113334222222432222153444395339553333335443355533333333333333333333333333333335555555999999999999",
	"999999999999955555555333333333333333333333355599999454334341112222112221594144444444395544443339553333333333333333333333333333333355555555999999999999",
	"999999999999955555555333333333333333333333355599995453441444111443341414359533359999555533455555333333333333333333333333333333333355555555999999999999",
	"999999999999995555555533333333333333333333355553344444443445434355334434433339999999999955555555333333333333333333333333333333333355555555999999999999",
	"999999999999995555555553333333334444444411144414343444444444341435553441153599999999555555541214334444433333333333333333333333333355555559999999999999",
	"999999999999999555555553333333334444411122435341433343445545344435534134443999999955555555534453333344443333333333333333333333333335555559999999999999",
	"999999999999999555555555333333334444444433444595439994344553555399533114393995555555555555332444444444444333333333333333333333333335555559999999999999",
	"999999999999999955555555533333334444444444353559345599544413934395543354495555555533333333333333344444444333333333333333333333334335555559999999999999",
	"999999999999999955555555553333333344444444433999334553935943533534534355555553333333333333333333333343334441444444333344441244343355555559999999999999",
	"999999999999999999555555555333333333333444433559541544355534533441135355555333333333333333333333333334444443444444141111222493433355555599999999999999",
	"999999999999999999955555555553333333333333333335993445355954543535133535533333333333333333333333333333333334414444211122122433333555555599999999999999",
	"999999999999999999995555555555533333333333333333359344435334335535455355333333333333333333333333333333333334444111111144333433335555555999999999999999",
	"999999999999999999999955555555555533333333333335555994445553333344435955333333333333333333333333333333333333333333333333333333355555559999999999999999",
	"999999999999999999999999555555555555555333333333555559344444445555595533333333333333333333335333333333333333333333333333335555555555599999999345999999",
	"999999999999999999999999995555555555555555555333355555993455555995555533333333333335555555555555555555555555555555555555555555555555955999511193499999",
	"999999999999999999999999999955555555555555555555555555555999955555555333333335555555555555555555555555555555555555555555555555555599995951333314999999",
	"999999999999999999999999999999995555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555599999999445333499999999",
	"999999999999999999999999999999999999555555555555555555555555555555555555555555555555555555555555555555555555555555555555555999999999955133345954599999",
	"999999999999999999999999999999999999999999955555555555555555555555555555555555555555555555599999999999999999999999999999999999999999534551599993999999",
	"999999999999999999999999999999999999999999999999955555555555555555555555555555555599999999999999999999999999999999999999999999999999333359999999999999",
	"999999999999999999999999999999999999999999999999999999955555555555559959999999999999999999999999999999999999999999999999999999999999999999999999999999",
	"999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999",
	"999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999"
	};
	*/

	LoadMap();
	fullMapSize = Size(map);
	viewSize = Size(21, 21);
}

void Level::DisplayMap(const Size& _size, const Coords& _center)const
{
	const u_int& _mapSize = static_cast<const u_int&>(_size.sizeX);
	for (u_int _rowIndex = 0; _rowIndex < _mapSize; _rowIndex++)
	{
		const u_int& _rowSize = static_cast<const u_int&>(_size.sizeY);
		for (u_int _columnIndex = 0; _columnIndex < _rowSize ; _columnIndex++)
		{
			Display(map[_rowIndex][_columnIndex], false);
		}
		cout << endl;
	}
}

Coords Level::ComputeCenter(const Coords& _cursorPos) const
{
	return
	{
		static_cast<int>(_cursorPos.x - viewSize.sizeX / 2.0f),
		static_cast<int>(_cursorPos.y - viewSize.sizeY / 2.0f)
	};
}

void Level::DisplayView(const Coords& _cursorPos)
{
	DisplayMap(viewSize, ComputeCenter(_cursorPos));
}

void Level::DisplayFullMap()
{
	DisplayMap(fullMapSize);
}

void Level::LoadMap()
{
	const string& _path = "Asset/Map/DefaultLevel.txt";
	FileStream _stream = FileStream(_path);

	vector<string> _map = _stream.ReadAll();

	map = _map;

}

